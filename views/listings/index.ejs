<% layout("layouts/boilerplate") %>

<div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">

  <!-- Filter Icons -->
  <div id="filters-container">
    <div class="arrow-buttons">
      <button class="arrow-btn" onclick="scrollLeft()"><i class="fa-solid fa-arrow-left"></i></button>
    </div>

    <div class="filters-wrapper" id="filtersWrapper">
      <div id="filters">
        <a href="/listings?category=Amazing Pools" class="filter <%= currentCategory === 'Amazing Pools' ? 'active-filter' : '' %>"><i class="fa-solid fa-person-swimming"></i><p>Amazing Pools</p></a>
        <a href="/listings?category=Rooms" class="filter <%= currentCategory === 'Rooms' ? 'active-filter' : '' %>"><i class="fa-solid fa-bed"></i><p>Rooms</p></a>
        <a href="/listings?category=Trending" class="filter <%= currentCategory === 'Trending' ? 'active-filter' : '' %>"><i class="fa-solid fa-fire"></i><p>Trending</p></a>
        <a href="/listings?category=Farms" class="filter <%= currentCategory === 'Farms' ? 'active-filter' : '' %>"><i class="fa-solid fa-money-bill-wheat"></i><p>Farms</p></a>
        <a href="/listings?category=Beach" class="filter <%= currentCategory === 'Beach' ? 'active-filter' : '' %>"><i class="fa-solid fa-umbrella-beach"></i><p>Beach</p></a>
        <a href="/listings?category=Big House" class="filter <%= currentCategory === 'Big House' ? 'active-filter' : '' %>"><i class="fa-solid fa-city"></i><p>Big House</p></a>
        <a href="/listings?category=Artic" class="filter <%= currentCategory === 'Artic' ? 'active-filter' : '' %>"><i class="fa-solid fa-snowflake"></i><p>Artic</p></a>
        <a href="/listings?category=Lake" class="filter <%= currentCategory === 'Lake' ? 'active-filter' : '' %>"><i class="fa-solid fa-water"></i><p>Lake</p></a>
        <a href="/listings?category=Iconic Cities" class="filter <%= currentCategory === 'Iconic Cities' ? 'active-filter' : '' %>"><i class="fa-solid fa-mountain-city"></i><p>Iconic Cities</p></a>
        <a href="/listings?category=Camping" class="filter <%= currentCategory === 'Camping' ? 'active-filter' : '' %>"><i class="fa-solid fa-tents"></i><p>Camping</p></a>
        <a href="/listings?category=Domes" class="filter <%= currentCategory === 'Domes' ? 'active-filter' : '' %>"><i class="fa-solid fa-igloo"></i><p>Domes</p></a>
        <a href="/listings?category=HouseBoats" class="filter <%= currentCategory === 'HouseBoats' ? 'active-filter' : '' %>"><i class="fa-solid fa-ship"></i><p>HouseBoats</p></a>
      </div>
      
    </div>

    <div class="arrow-buttons">
      <button class="arrow-btn" onclick="scrollRight()"><i class="fa-solid fa-arrow-right"></i></button>
    </div>
  </div>

<!-- Listings Grid -->
<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3 g-4">
  <% for(let listing of allListings) { %>
    <div class="col">
      <div class="card listing-card position-relative h-100">

        <!-- ❤️ Heart Icon -->
        <div
          class="position-absolute top-0 end-0 p-2"
          onclick="event.stopPropagation(); toggleHeart(this);"
          style="z-index: 10;"
        >
          <i class="fa-regular fa-heart favorite-icon"></i>
        </div>

        <!-- Clickable Link starts BELOW the heart -->
        <a href="/listings/<%= listing._id %>" class="listing_link text-decoration-none">
          <img
            src="<%= listing.image.url %>"
            class="card-img-top"
            alt="listing_image"
            style="height: 16rem; object-fit: cover;"
          />
          <div class="card-body">
            <p class="card-text mb-1">
              <b><%= listing.title %></b>
            </p>
            <p class="mb-0 text-muted">
              ₹<%= listing.price.toLocaleString("en-IN") %>/night
              <i class="tax-info"> +18% GST</i>
            </p>
          </div>
        </a>
      </div>
    </div>
  <% } %>
</div>
